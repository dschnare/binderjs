/*
Author: Darren Schnare
Keywords: javascript,binding,bind,property,list,observer,observable
License: MIT ( http://www.opensource.org/licenses/mit-license.php )
Repo: https://github.com/dschnare/binderjs
*/
var BINDER=function(){"use strict";var s=[].constructor,h={}.constructor,n=function(){var t=null,n=null,r=null;return function(){var h={}.constructor,s=function(n){return n===null||n===undefined},f=function(){var n=h.prototype.toString;return function(t){return n.call(t)==="[object Array]"||!s(t)&&typeof t.length=="number"&&typeof t.push=="function"}}(),i=function(n){return n===null?"null":f(n)?"array":typeof n},o=function(n){return n&&i(n)==="object"},e=function(n){return n===undefined||n===null?"":n.toString()},c=function(n){var u=arguments.length,r,t,i;if(u===0||!n)throw new Error("Expected at least one object as an argument.");for(r=1;r<u;r+=1){t=arguments[r];if(!s(t))for(i in t)t.hasOwnProperty(i)&&(n[i]=t[i])}return n},u={typeOf:i,isObject:o,isArray:f,isNil:s,mixin:c,str:e,respondsTo:function(n,t){return n&&typeof n[t]=="function"},adheresTo:function(n,t){var r,s,u;if((o(n)||typeof n=="function"||f(n))&&(o(t)||typeof t=="function"||f(t))){for(r in t)if(t.hasOwnProperty(r))if(t[r]==="*"){if(!n.hasOwnProperty(r))return!1}else if(i(n[r])!==i(t[r])&&i(n[r])!==e(t[r]))return!1;return!0}return s=i(n),u=i(t),s===u},create:function(){var n=function(){};return function(t){if(!t)throw new Error("Expected an object as an argument.");return n.prototype=t,new n}}(),trim:function(n){n=n?n.toString():"";var t=0,i=n.charAt(t);while(i){if(i>" "){n=n.substring(t);break}t+=1,i=n.charAt(t)}t=n.length;while(t){t-=1,i=n.charAt(t);if(i>" "){n=n.substring(0,t+1);break}}return n},format:function(n){var r=e(n),s=arguments,h=s.length,u=r.length,i=null,t=0,o=0,f=function(){return u-=1,i=r.charAt(u)};while(f())if(i==="}"){o=u+1,f(),t="";while(i>="0"&&i<="9")t=i+t,f();i==="{"&&(t=parseInt(t,10)+1,t<h&&(r=r.substring(0,u)+s[t]+r.substring(o)))}return r}};if(typeof t=="function"&&typeof t.amd=="object")t(u);else if(n&&typeof n=="object"&&typeof r=="function")u.mixin(n,u);else return u}()}(),t=function(n){var u=[].constructor,r={equals:function(n,t){return n=n?n.valueOf():n,t=t?t.valueOf():t,n===t},changed:function(n,t){return n=n?n.valueOf():n,t=t?t.valueOf():t,!1}},i=function(t,i,r,u,f){return{status:t,item:i,value:i,index:r,otherItem:u,otherIndex:f,toString:function(){var e="{status: {0}, item: {1}, index: {2}, otherItem: {3}, otherIndex: {4}}";return n.format(e,t,i,r,u,f)}}},t=function(f){var e=[];return e.getItemOperators=function(){return n.create(r)},e.indexOf=e.indexOf||function(n,t){var i,r=this.length;t=isNaN(t)?0:t;if(r===0)return-1;if(t>=r)return-1;for(t<0&&(t=r+t),t<0&&(t=0),i=t;i<r;i+=1)if(this[i]===n)return i;return-1},e.lastIndexOf=e.lastIndexOf||function(n,t){var i,r=this.length,u=function(n,t){return n<t?n:t};if(r===0)return-1;for(t=isNaN(t)?r:t,t<0||(t=u(t,r-1)),t<0&&(t=r+t),i=t;i>=0;i-=1)if(this[i]===n)return n=null,i;return n=null,-1},e.reverse=e.reverse||function(){var n=0,r=this.length,t=r-1,u=parseInt((r/2).toFixed(0),10),i;while(n<u)i=this[t],this[t]=this[n],this[n]=i,t-=1,n+=1;return this},e.map=e.map||function(n,t){var i=0,f=this.length,r=new u(f);if(typeof n!="function")throw new Error("TypeError");for(i=0;i<f;i+=1)this.hasOwnProperty(i)&&(r[i]=n.call(t,this[i],i,this));return r},e.filter=e.filter||function(n,t){var i,r,f=this.length,u=[];if(typeof n!="function")throw new Error("TypeError");for(i=0;i<f;i+=1)this.hasOwnProperty(i)&&(r=this[i],n.call(t,r,i,this)&&u.push(r));return u},e.forEach=e.forEach||function(n,t){var i,r=this.length;if(typeof n!="function")throw new Error("TypeError");for(i=0;i<r;i+=1)this.hasOwnProperty(i)&&n.call(t,this[i],i,this)},e.reduce=e.reduce||function(n,t){var f=this.length,i=0,u,r;if(typeof n!="function")throw new Error("TypeError");if(f===0&&arguments.length===1)throw new Error("TypeError");if(arguments.length===2)u=t;else{r=!1,i=0;while(!r&&i<f)r=this.hasOwnProperty(i),r&&(u=this[i]),i+=1}while(i<f)r=this.hasOwnProperty(i),r&&(u=n.call(undefined,u,this[i],i,this)),i+=1;return u},e.reduceRight=e.reduceRight||function(n,t){var f=this.length,i=f-1,u,r;if(typeof n!="function")throw new Error("TypeError");if(f===0&&arguments.length===1)throw new Error("TypeError");if(arguments.length===2)u=t;else{r=!1;while(!r&&i>=0)r=this.hasOwnProperty(i),r&&(u=this[i]),i-=1}while(i>=0)r=this.hasOwnProperty(i),r&&(u=n.call(undefined,u,this[i],i,this)),i-=1;return u},e.some=e.some||function(n,t){var r=this.length,i;if(typeof n!="function")throw new Error("TypeError");for(i=0;i<r;i+=1)if(this.hasOwnProperty(i))if(n.call(t,this[i],i,this))return!0;return!1},e.every=e.every||function(n,t){var r=this.length,i;if(typeof n!="function")throw new Error("TypeError");for(i=0;i<r;i+=1)if(this.hasOwnProperty(i))if(!n.call(t,this[i],i,this))return!1;return!0},e.contains=function(n){return this.indexOf(n)>=0},e.occurances=function(n){var t=this.indexOf(n),i=0;while(t>=0)i+=1,t=this.indexOf(n,t+1);return i},e.distinct=function(){var t=this.length,i=[],n;while(t)t-=1,n=this[t],this.occurances(n)===1&&i.unshift(n);return i},e.first=function(n,t){var i,r=this.length;if(typeof n!="function")throw new Error("TypeError");for(i=0;i<r;i+=1)if(this.hasOwnProperty(i))if(n.call(t,this[i],i,this))return this[i];return undefined},e.last=function(n,t){var i=this.length;if(typeof n!="function")throw new Error("TypeError");while(i){i-=1;if(this.hasOwnProperty(i))if(n.call(t,this[i],i,this))return this[i]}return undefined},e.find=function(n,t,i){var r,u=this.length;if(typeof n!="function")throw new Error("TypeError");for(typeof t=="number"||i||(i=t),(isNaN(t)||t<0)&&(t=0),r=t;r<u;r+=1)if(this.hasOwnProperty(r))if(n.call(i,this[r],r,this))return{item:this[r],index:r};return{item:undefined,index:-1}},e.equals=function(i,r){var u,s,h,f=this,e=i,o;if(!n.isArray(i))return!1;if(f===e)return!0;if(f.length!==e.length)return!1;for(s=f.length,h=e.length,o=t.getItemOperators(this),r=typeof r=="function"?r:function(){return o.equals.apply(o,arguments)},u=0;u<s&&u<h;u+=1)if(!r(f[u],e[u]))return!1;return!0},e.changed=function(i,r,u){var f,h,c,e=this,o=i,s;if(!n.isArray(i))return!1;if(e===o)return!1;if(e.length!==o.length)return!0;for(s=t.getItemOperators(this),r=typeof r=="function"?r:function(){return s.equals.apply(s,arguments)},u=typeof u=="function"?u:function(){return s.changed.apply(s,arguments)},h=e.length,c=o.length,f=0;f<h&&f<c;f+=1)if(!r(e[f],o[f])||u(e[f],o[f]))return!0;return!1},e.compare=function(n,r,u){var s,h=t(),f,c,e,a=this.find,l,o;for(n=t(n),s=t.getItemOperators(this),r=typeof r=="function"?r:function(){return s.equals.apply(s,arguments)},u=typeof u=="function"?u:function(){return s.changed.apply(s,arguments)},l=function(n){return r(e,n)},c=this.length,f=0;f<c;f+=1)e=this[f],o=a.call(n,l),o.index<0?h.push(i("deleted",e,f)):(u(e,o.item)?h.push(i("changed",e,f,o.item,o.index)):h.push(i("retained",e,f,o.item,o.index)),delete n[o.index]);for(c=n.length,f=0;f<c;f+=1)n.hasOwnProperty(f)&&(e=n[f],this.find(l).index<0&&h.push(i("added",undefined,-1,e,f)));return e=n=r=u=null,h},e.merge=function(n,i,r){var u=t(this);return u.mergeWith(n,i,r),u},e.mergeWith=function(n,i,r){var f,o,e,u;f=t.getItemOperators(this),o=this.compare(n,i,r),e=o.length,this.length=n.length;while(e){e-=1,u=o[e];switch(u.status){case"added":this[u.otherIndex]=u.otherItem;break;case"deleted":f.equals(this[u.index],u.item)&&(this[u.index]=undefined);break;case"changed":f.equals(this[u.index],u.item)&&(this[u.index]=undefined),this[u.otherIndex]=u.otherItem;break;case"retained":f.equals(this[u.index],u.item)&&(this[u.index]=undefined),this[u.otherIndex]=u.item}}this.collapse()},e.remove=function(){for(var n,i,r=arguments.length,t=0;t<r;t+=1){i=arguments[t],n=this.length;while(n)n-=1,this[n]===i&&this.splice(n,1)}},e.removeAt=function(n){if(isFinite(n)&&n>=0&&n<this.length)return this.splice(n,1).pop()},e.clear=function(){while(this.length)this.pop()},e.collapse=function(){var n=this.length;while(n)n-=1,this[n]===undefined&&this.splice(n,1)},e.replaceAt=function(n,t){var i;return isFinite(n)&&n>=0&&n<this.length&&(i=this[n],this[n]=t),i},e.isEmpty=function(){return this.length===0},e.peek=function(){return this[this.length-1]},e.insert=function(n,t){return n>this.length+1?n=this.length+1:n<0&&(n=0),n>=0?(n===this.length+1?this.push(t):this.hasOwnProperty(n)?this.splice(n,0,t):this[n]=t,!0):!1},function(t){var i=t.length;i===1&&n.isArray(f)?e.push.apply(e,f):i&&e.push.apply(e,e.slice.call(t))}(arguments),e};return t.getItemOperators=function(n){var t=n.getItemOperators();return typeof t.equals!="function"&&(t.equals=r.equals),typeof t.changed!="function"&&(t.changed=r.changed),t},t.interfce={concat:"function",indexOf:"function",join:"function",lastIndexOf:"function",map:"function",filter:"function",forEach:"function",reduce:"function",reduceRight:"function",reverse:"function",some:"function",shift:"function",slice:"function",sort:"function",splice:"function",every:"function",pop:"function",push:"function",unshift:"function",toString:"function",contains:"function",occurances:"function",distinct:"function",first:"function",last:"function",find:"function",equals:"function",changed:"function",compare:"function",merge:"function",mergeWith:"function",remove:"function",removeAt:"function",clear:"function",collapse:"function",replaceAt:"function",isEmpty:"function",peek:"function",insert:"function"},t}(n),f=function(n,t){var r=function(n,t){for(var i,u=t.length,r=0;r<u;r+=1){i=t[r];if(i)if(typeof i=="function")i(n);else if(typeof i.onNotify=="function")i.onNotify(n)}},i=function(){var i=n(),e=0,u=!1,f=[],o=-1;return{block:function(){f.push(!0)},unblock:function(){f.pop()},subscribe:function(n){return n&&!i.contains(n)?(i.push(n),{dispose:function(){i.remove(n)}}):{dispose:function(){}}},throttle:function(n){isFinite(n)||(n=0),e=n},notify:function(){var n=this;if(f.length||u)return;u=!0,e>0?o=t(function(){r(n,i),u=!1},e):(r(n,i),u=!1)},dispose:function(){i.clear(),clearTimeout(o)}}};return i.interfce={block:"function",unblock:"function",subscribe:"function",throttle:"function",notify:"function",dispose:"function"},i}(t,setTimeout),e=function(n,t,i){var r=function(){var u=[].slice,r=t.apply(undefined,u.call(arguments));return n.mixin(r,i()),r.remove=function(n){return function(){var i=this.length,t;return this.block(),t=n.apply(this,u.call(arguments)),this.unblock(),i!==this.length&&this.notify(),t}}(r.remove),r.removeAt=function(n){return function(){var i=this.length,t;return this.block(),t=n.apply(this,u.call(arguments)),this.unblock(),i!==this.length&&this.notify(),t}}(r.removeAt),r.replaceAt=function(n){return function(){var t;return this.block(),t=n.apply(this,u.call(arguments)),this.unblock(),this.notify(),t}}(r.replaceAt),r.clear=function(n){return function(){var i=this.length,t;return this.block(),t=n.call(this),this.unblock(),i!==this.length&&this.notify(),t}}(r.clear),r.collapse=function(n){return function(){var i=this.length,t;return this.block(),t=n.call(this),this.unblock(),i!==this.length&&this.notify(),t}}(r.collapse),r.insert=function(n){return function(){var t;return this.block(),t=n.apply(this,u.call(arguments)),this.unblock(),t&&this.notify(),t}}(r.insert),r.mergeWith=function(n){return function(){var t;return this.block(),t=n.apply(this,u.call(arguments)),this.unblock(),this.notify(),t}}(r.mergeWith),r.reverse=function(n){return function(){var t;return this.block(),t=n.call(this),this.unblock(),this.notify(),t}}(r.reverse),r.pop=function(n){return function(){var i=this.length,t;return this.block(),t=n.call(this),this.unblock(),i!==this.length&&this.notify(),t}}(r.pop),r.push=function(n){return function(){var i=this.length,t;return this.block(),t=n.apply(this,u.call(arguments)),this.unblock(),i!==this.length&&this.notify(),t}}(r.push),r.shift=function(n){return function(){var i=this.length,t;return this.block(),t=n.call(this),this.unblock(),i!==this.length&&this.notify(),t}}(r.shift),r.unshift=function(n){return function(){var i=this.length,t;return this.block(),t=n.apply(this,u.call(arguments)),this.unblock(),i!==this.length&&this.notify(),t}}(r.unshift),r.sort=function(n){return function(){var t=n.apply(this,u.call(arguments));return this.notify(),t}}(r.sort),r.splice=function(n){return function(){var i=this.length,t;return this.block(),t=n.apply(this,u.call(arguments)),this.unblock(),i!==this.length&&this.notify(),t}}(r.splice),r};return r.interfce=n.mixin({},i.interfce,t.interfce),r}(n,t,f),r=function(n,t,i,r,u){var f,e=t(),o=!1;return e.pushProperty=function(n){this.length?o&&this.peek().owner!==n.owner||this.push(n):this.push(n)},e.addDependency=function(n){this.length&&(o&&this.peek().owner!==n.owner||this.peek().dependencies().add(n))},f=function(o){var p=!1,c=t(),v=[],y,a,h,l,s,w=function(){h=undefined,l.notify()};return c.add=function(n){this.contains(n)||(this.push(n),v.push(n.subscribe(w)))},l={equals:function(n){var t=this.get();return n=f.get(n),t=t?t.valueOf():t,n=n?n.valueOf():n,t===n},changed:function(n){var t=this.get();return n=f.get(n),t=t?t.valueOf():t,n=n?n.valueOf():n,t!==n},clearMemo:function(){h=undefined},get:function(){p||(e.addDependency(this),e.pushProperty(this));var n=h===undefined?a.call(this.owner):h;return h=n,e[e.length-1]===this&&e.pop(),n},set:function(n){typeof y=="function"&&(p=!0,(!this.equals(n)||this.changed(n))&&(h=undefined,y.call(this.owner,n),this.notify()),p=!1)},dependencies:function(){return c},isDependent:function(){return c.length!==0},toString:function(){return n.str(this.get())},valueOf:function(){var t=this.get();return n.isNil(t)?t:t.valueOf()}},n.mixin(l,i()),function(){var e,h=l,k=!1,d=n.isObject,p=n.isArray,b=n.adheresTo;h.owner=undefined,typeof o=="function"?a=o:d(o)&&typeof o.get=="function"?(k=o.lazy,a=o.get,y=typeof o.set=="function"?o.set:null,h.equals=typeof o.equals=="function"?o.equals:h.equals,h.changed=typeof o.changed=="function"?o.changed:h.changed,h.owner=o.owner):(d(o)?(h.equals=typeof o.equals=="function"?o.equals:h.equals,h.changed=typeof o.changed=="function"?o.changed:h.changed,e=o.value):e=o,p(e)&&!b(e,i.interfce)&&(e=r(e),e.getItemOperators=function(n,t){return function(){return{equals:n,changed:t}}}(h.equals,h.changed),h.equals=function(n){return n=f.get(n),e.equals(n)},h.changed=function(n){return n=f.get(n),e.changed(n)}),e&&typeof e.subscribe=="function"&&typeof e.dispose=="function"&&v.push(e.subscribe(w)),a=function(){return e},y=function(n){if(b(e,t.interfce))e.clear(),p(n)?e.push.apply(e,n):e.push(n);else if(p(e)){while(e.length)e.pop();p(n)?e.push.apply(e,n):e.push(n)}else e!==n&&(e=n)}),h.dispose=function(n){return function(){while(v.length)v.pop().dispose();while(c.length)c.pop();n.call(this)}}(h.dispose),k||h.get(),s=function(n){var t,i=s.owner;return this!==u&&(s.owner=this),arguments.length?(s.set(n),t=this):t=s.get(),s.owner=i,t},n.mixin(s,l)}(),s},f.get=function(n){return n&&typeof n.get=="function"?n.get():n},f.interfce=n.mixin({owner:"*",dependencies:"function",isDependent:"function",clearMemo:"function",get:"function",set:"function",equals:"function",changed:"function"},i.interfce),f}(n,t,f,e,window),o=function(n,t){var i=function(i,r,u){var o=t.interfce,e=[],f;u=u||"twoway",u=n.str(u),u=u.toLowerCase();if(!n.adheresTo(i,o))throw new Error("Binding source must be an observable property. "+i);if(!n.adheresTo(r,o))throw new Error("Binding sink must be an observable property. "+r);r.set(i.get());switch(u){case"oneway":f=i.subscribe(function(){r.set(i.get())}),e.push(f);break;case"twoway":f=i.subscribe(function(){r.set(i.get())}),e.push(f),f=r.subscribe(function(){i.set(r.get())}),e.push(f)}return f=null,{type:function(){return u},source:function(){return i},sink:function(){return r},dispose:function(){while(e.length)e.pop().dispose()}}};return i.interfce={type:"function",source:"function",sink:"function",dispose:"function"},i}(n,r),i=function(t,u){var o,h,s,e,f={},a=n.isObject,v=n.isArray,c=n.adheresTo,l=r.interfce;if(v(t)){for(h=t.length,f=[],o=0;o<h;o+=1)f.push(i(t[o]));return f}if(!a(t))return t;for(s in t)e=t[s],c(e,l)?e.isDependent()&&u||(f[s]=i(e.get())):f[s]=e;return f},u={utiljs:n,makeList:t,makeObservable:f,makeObservableList:e,makeProperty:r,makeBinding:o,toObject:i};if(typeof define=="function"&&typeof define.amd=="object"&&define.amd)define(u);else if(typeof exports=="object"&&exports&&typeof require=="function")n.mixin(exports,u);else return u}()