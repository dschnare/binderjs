<!DOCTYPE html>
<html>
	<head>
		<title>Binderjs Test Page</title>
		<meta charset="utf-8">
		<script type="text/javascript" src="inc/scripts/util.min.js"></script>
		<script type="text/javascript" src="inc/scripts/binder.js"></script>
		<!--script type="text/javascript" src="inc/scripts/binder.all.js"></script-->
		<script type="text/javascript" src="inc/scripts/unit.js"></script>
		<script type="text/javascript" src="inc/scripts/binderjs-spec.js"></script>
	</head>
	<body onload="UNIT.console.show()">
		<div id="display-name"></div>
		<div id="skills"></div>

		<script type="text/javascript">
			// Create a person object that has a firstName and lastName property.
			var person = {
				firstName: BINDER.makeProperty('Darren'),
				lastName: BINDER.makeProperty('Schnare'),
				skills: BINDER.makeProperty(['javascript', 'html', 'css', 'ruby'])
			};


			// Now give our person object a fullName property that
			// depends on the values of firstName and lastName.
			person.fullName = BINDER.makeProperty({
				get: function () {
					// We can treat properties like simple values
					// because even though properties are functions
					// they have their 'valueOf' methods overriden
					// to provide the value of the property.
					return this.firstName + ' ' + this.lastName;
				},
				// We have to specify the owner of this property
				// because we are using 'this' inside the property's
				// get operator.
				owner: person
			});

			// When either of the firstName or lastName are changed
			// we will be notified and then we can read the value
			// of fullName and do something with it.
			person.fullName.subscribe(function (fullName) {
				document.getElementById('display-name').innerHTML = fullName();
			});

			// Let's watch our skills too. If they change then we want to do
			// something with them as well.
			person.skills.subscribe(function (skills) {
				document.getElementById('skills').innerHTML = skills().join(', ');
			});


			// So now we have a person model and some observers on the fullName and skills
			// properties. Let's 'prime-the-pump' so to speak by forcing our observers on
			// fullName and skills to be notified and updating the DOM.
			person.fullName.notify();
			person.skills.notify();



			// Sometime later in our code ...

			// Just be setting these properties we cause the fullName
			// property to be notified of their changes then this change
			// is relayed to our subscriber on fullName.
			person.firstName('Super');
			person.lastName('Mario');

			// Likewise with our list of skills, any changes will automatically
			// be observed and the DOM is updated. Here we merge a new list of
			// skills into our existing list of skills so that we get one
			// change notifiaction and the DOM only gets updated once. This has
			// the affect of completely replacing our list of skills with a new list.
			person.skills().mergeWith(['saving princess toadstool', 'beating bowser to a pulp', 'plumbing']);
		</script>
	</body>
</html>